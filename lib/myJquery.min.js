/* myJquery 2014-09-10  by yansm*/
window.stopBubble=function(a){return a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0,!1},function(a){a.getUrlParam=function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null}}(jQuery),function(a){a.fn.downDelay=function(b){var c,d={downDuring:300,downEvent:function(){a.noop()}},e=a.extend(d,b||{});return a(this).each(function(){a(this).mousedown(function(){c=setTimeout(e.downEvent,e.downDuring)}).mouseup(function(){clearTimeout(c)})})}}(jQuery),$(function(){function a(){return e.hasClass("type_top")?(h.css({left:"0px",top:"0px"}),c):e.hasClass("type_bottom")?(h.css({left:"0px",top:"0px"}),c):0}function b(){f=e.width(),g=e.height()}$(".needtooltip").tooltip();var c=300,d=$.getUrlParam("menuIndex"),e=$("body"),f=e.width(),g=e.height(),h=$(".indexMenu li"),i=$(".module_info li"),j=($(".area_right"),{normal:function(){var b=a();setTimeout(function(){e.removeClass().addClass("type_normal"),h.css({left:"0px",top:"0px",height:g/7+"px"})},b)},left:function(){var b=a();e.hasClass("type_left")&&(b=c+350,e.removeClass(),h.css({left:"0px",top:"0px",height:g/7+"px"})),setTimeout(function(){e.removeClass().addClass("type_left"),h.css({left:"-"+(f-90)+"px",top:"0px",height:g/7+"px"})},b)},right:function(){var b=a();e.hasClass("type_right")&&(b=c,e.removeClass()),setTimeout(function(){e.removeClass().addClass("type_right"),h.css({left:"0px",top:"0px",height:g/7+"px"})},b)},top:function(){e.hasClass("type_bottom")?(e.addClass("type_top").addClass("type_top_end").removeClass("type_bottom").removeClass("type_bottom_end"),h.css({left:"0px",top:"43px"})):(e.removeClass().addClass("type_top_end"),h.css({left:"0px",top:"0px"}),setTimeout(function(){e.addClass("type_top"),h.css({left:"0px",top:"43px"})},c))},bottom:function(){e.hasClass("type_top")?(e.addClass("type_bottom").addClass("type_bottom_end").removeClass("type_top").removeClass("type_top_end"),h.css({left:"0px",top:"-43px"})):(e.removeClass().addClass("type_bottom_end"),h.css({left:"0px",top:"0px"}),setTimeout(function(){e.addClass("type_bottom"),h.css({left:"0px",top:"-43px"})},c))}});h.hover(function(){var a=$(this),b=a.index();i.removeClass("current"),i.eq(b).addClass("current")}).click(function(){var a=$(this),b=a.data("type"),d=a.data("target"),f=$(".area_"+b),g=f.data("flag")?f.data("flag"):"";d&&0==f.find(".box_"+d).length&&(f.append('<div class="scroll-pane box box_'+d+'"></div>'),f.find(".box_"+d).load(d+".html",function(){f.find(".box_"+d).jScrollPane(),$.initModule({target:d})})),d&&(e.hasClass("type_"+b)&&g!=d&&"right"==b?setTimeout(function(){f.data("flag",d).find("> * ").removeClass("active"),f.find(".box_"+d).addClass("active")},c):(f.data("flag",d).find("> * ").removeClass("active"),f.find(".box_"+d).addClass("active"))),e.hasClass("type_"+b)&&g==d||j[b]()}),b(),window.onresize=function(){b()},$.extend({getValues:function(){return{bodyWidth:f,bodyHeight:g,animateTime:c}}}),d?h.eq(d).click():h.eq(0).click()}),$(function(){function a(){function a(){d.each(function(){var a=$(this),b=a.height();a.css("height",b+"px")})}$(".needtooltip").tooltip();var b=data_myInformation,c=$(".box_myInformation"),d=c.find(".panel"),e=c.find(".append_menu input"),f=c.find(".info_area"),g=f.length;f.each(function(d){var e=$(this),f=e.data("infovalue");e.html(b[f]),d==g-1&&(c.jScrollPane(),a())}),e.change(function(){var a=$(this),b=a.data("target"),c=a.is(":checked"),d=$("#"+b),e=d.data("distype");c?d.removeClass("distype_"+e+"_animate"):d.addClass("distype_"+e).addClass("distype_"+e+"_animate")}),d.each(function(){var a=$(this),b=a.find(".close"),d=a.attr("id");b.click(function(){c.find('.append_menu input[data-target="'+d+'"]').click()})})}function b(){function a(a){function b(a){var b=d.find("> li");b.removeClass("actived"),b.eq(a).addClass("actived"),t.scrollToElement(b.eq(a),!0,!0)}var c=$(".album_normal"),d=c.find(".photos_list"),e=j[a],f=e.photos,g=f.length,h=e.url,i=[],k=[],l=$(".album_list"),m=c.find(".left_area"),n=(l.width(),l.height());d.html("").removeAttr("style");for(var o=0;g>o;o++){var p=f[o],q=p.text,r=p.title,s=p.description;i.push('<li class="rel"><img src="'+h+q+'" ><aside class="abs tc">'+r+"</aside></li>"),k.push({imgUrl:h+q,description:s})}d.html(i.join("")),m.jScrollPane();var t=m.data("jsp");l.buildPhotos({imgMap:k,automatic:0,animateStyle:"move",hasToolbar:!1,hasDescription:!0,photoWidth:l.width(),photoHeight:l.height(),clickExEvent:function(a){b(a)}}),d.find("> li").click(function(){var a=$(this),c=a.index();b(c),l.toPage({num:c})}),l.find("img").draggable({stop:function(a,b){var c=b.helper,d=b.offset.top,e=(b.offset.left,c.width(),c.height());d>0?c.animate({top:"0px"},{queue:!1,duration:300}):n-e>d&&c.animate({top:n-e+"px"},{queue:!1,duration:300})}}),d.find(">li").get(0).click()}function b(a){function b(a){for(var b=[],c=0;a>c;c++)b.push(c);for(var c=0;a>c;c++){var d=parseInt(Math.random()*(a-c));b.push(b[d]),b.splice(d,1)}return b}var c=$(".album_wall_area"),d=c.find("li> div"),e=j[a],f=e.photos,g=f.length,h=e.url,i=c.width(),k=c.height()/3,l=[!0,!0,!0];d.empty();for(var m=b(g);l[0]||l[1]||l[2];){var n=[],o=0;n.push(d.eq(0).width()),n.push(d.eq(1).width()),n.push(d.eq(2).width());for(var p=0,q=n.length;q>p;p++)n[p]<n[o]&&(o=p);0==m.length&&(m=b(g));var r=d.eq(o),s=m[m.length-1],t=f[s],u=t.text,v=t.width,w=t.height,x=t.title;m.pop(),r.append('<div class="img_box rel" style="width: '+v/w*k+'px"><img src="'+h+u+'" /><aside class="abs tc">'+x+"</aside></div>"),l[o]=r.width()<i}}function c(a){var b=$(".album_mark");b.html('<div id="wrapper"><div id="carousel"></div></div><div id="donate-spacer"></div>');for(var c=$("#carousel"),d=j[a],e=d.photos,f=e.length,g=d.url,h=b.width(),i=b.height(),k=[],l=0;f>l;l++){{var m=e[l],n=m.text,o=m.title;m.description}k.push('<div><img src="'+g+n+'" alt="'+o+'" width="'+(h-400)+'" height="'+i+'" /></div>')}c.removeAttr("style").html(k.join("")).find(">div").css("margin-right",500-h+"px"),c.carouFredSel({width:h,height:i,align:!1,padding:[0,950,0,0],items:{width:100,height:i,visible:5,minimum:1},scroll:{items:1,duration:750,onBefore:function(a){a.items.old.add(a.items.visible).find("span").stop().slideUp()},onAfter:function(a){a.items.visible.last().find("span").stop().slideDown()}},auto:!1,onCreate:function(){$(this).children().each(function(){$(this).append("<span>"+$("img",this).attr("alt")+"</span>"),$(this).find("span").hide()})}}),c.children().click(function(){c.trigger("slideTo",[this,-4,"prev"])})}function d(a){for(var b=a,c=b.length,d=[],f=$(".photos_area"),g=0;c>g;g++){var h=b[g],i=h.title,j=h.url,k=(h.id,h.type);d.push('<div class="photo_area" data-index="'+g+'"><div class="photo_box3" data-type="'+k[1]+'"><div class="photo_content tc">'+n[k[1]]+"</div></div>"),d.push('<div class="photo_box2" data-type="'+k[0]+'"><div class="photo_content tc">'+n[k[0]]+'</div></div><div class="photo_box" data-type="normal"><div class="photo_content tc">'),d.push('<img src="'+j+'index.jpg" />'),d.push("<aside>"+i+"</aside>"),d.push("</div></div></div>")}f.append(d.join("")),f.find(".photo_area > div").click(function(){e($(this))})}function e(a){var b=a,c=b.parent().offset(),d=c.left,e=c.top,j=b.data("type"),l=b.parent().data("index");b.hasClass("current")||(b.addClass("current").css({width:g-80+"px",height:f-40+"px",top:60-e+"px",left:f-d-20+"px"}),k.find(".content_area").css("width",f-291+"px"),k.find(".album").removeClass("current"),k.find(".album_"+j).addClass("current"),i.addClass("box_myPhotos_actived"),o[j](l),setTimeout(function(){k.css("opacity","1")},2*h))}$(".needtooltip").tooltip();var f=$.getValues().bodyWidth,g=$.getValues().bodyHeight,h=$.getValues().animateTime,i=$(".box_myPhotos"),j=data_myPhotos,k=$(".album_box"),l=$(".photos_area"),m=$(".album_toolbar");$("#myPhoto_adjust").click(function(){i.toggleClass("neight_style")});var n={wall:'<img src="./images/wall.png"/><aside>照片墙</aside>',mac_wall:'<img src="./images/wall.png"/><aside>照片墙</aside>',mark:'<img src="./images/mark.png"/><aside>书签夹</aside>'};d(j);var o={normal:a,wall:b,mark:c};k.find("div.toolbar .close").click(function(){var a=l.find("div.current");k.removeAttr("style"),setTimeout(function(){a.removeClass("current").removeAttr("style"),i.removeClass("box_myPhotos_actived")},h)}),m.find(".glyphicon-zoom-in").click(function(){var a=$(".album_list"),b=a.data("index"),c=a.find('div.photo_item li[data-index="'+b+'"] img');c.height(1.1*c.height())}),m.find(".glyphicon-zoom-out").click(function(){var a=$(".album_list"),b=a.data("index"),c=a.find('div.photo_item li[data-index="'+b+'"]'),d=c.find("img"),e=d.height()/1.1;d.height(e<c.height()?"100%":e)})}function c(){var a=($.getValues().bodyWidth,$.getValues().bodyHeight,$.getValues().animateTime),b=data_myArticle,c=$(".box_myArticle"),d=c.find("div.content"),e=c.height(),f=c.width(),g=c.find("div.article_menu_box"),h=c.find(".wall_paper"),i=c.find(".article_main_area"),j=$(".main_area_essay"),k=$(".main_area_phrase"),l=$(".main_area_novel");d.height(e),d.click(function(){var a=j.find(".active"),b=k.find(".active"),c=l.find(".active");a.length>0&&(a.removeClass("active"),a.parent().css("margin-top","0px")),b.closePhrase(),c.closeNovel()}),g.click(function(){var a=$(this),b=a.data("target"),c=a.index();h.find(">div").removeClass("current"),h.find(".wall_paper_"+b).addClass("current"),i.css("margin-top",0-e*c+"px")}),function(){for(var c=b.essay,d=c.length,f=[],g=j.find("div.previous_essay"),h=j.find("div.next_essay"),i=Math.floor((e-100)/80),k=0,l=Math.ceil(d/i);l>k;k++){f.push(0==k?'<ul class="essay_list current">':'<ul class="essay_list">');for(var m=i*k,n=i*(k+1)>d?d:i*(k+1);n>m;m++){var o=c[m],p=o.title,q=o.date,r=o.content;f.push('<li class="essay_item rel" data-index="'+m+'"><div class="essay_title">'+p+" <aside>"+q+'</aside></div><div class="scroll-pane ovh"><div class="essay_content "><p>'+r.join("</p><p>")+"</p></div></div></li>")}f.push("</ul>")}j.append(f.join("")),j.find(".essay_item").click(function(a){stopBubble(a)}),j.find(".essay_title ").click(function(b){{var d=$(this),e=d.parent(),f=d.next(),g=e.parent(),h=j.find(".active"),i=d.offset().top,k=e.data("index"),l=c[k];l.content}0==h.length?(e.addClass("active"),g.css("margin-top",32-i+"px"),setTimeout(function(){f.jScrollPane()},a)):(h.removeClass("active"),g.css("margin-top","0px")),stopBubble(b)}),g.click(function(){var a=j.find(">.current"),b=a.prev();a.removeClass("current"),b.length>0&&b.hasClass("essay_list")?b.addClass("current"):j.find(".essay_list:last-child").addClass("current")}),h.click(function(){var a=j.find(">.current"),b=a.next();a.removeClass("current"),b.length>0&&b.hasClass("essay_list")?b.addClass("current"):j.find(".essay_list").first().addClass("current")})}(),function(){for(var c=b.phrase,d=c.length,f=['<ul class="phrase_list">'],g=0;d>g;g++){var h=c[g],i=h.title,j=(h.date,h.content);f.push('<li class="phrase_box"><div class="phrase_item phrase_page0'+(g%4+1)+'" data-index="'+g+'"><h3>'+i+'</h3><div class="scroll-pane ovh"><div class="phrase_content"><p>'+j.join("</p><p>")+"</p></div></div></div></li>")}f.push("</ul>"),k.append(f.join(""));var l=k.find("div.phrase_item h3");l.click(function(b){var c=$(this),d=c.next(),f=c.parent(),g=f.data("index");f.hasClass("active")?f.closePhrase():(f.addClass("active").css({top:0-140*g-32+"px","z-index":"1"}),setTimeout(function(){f.css("height",e+"px"),setTimeout(function(){d.jScrollPane()},a)},a)),stopBubble(b)}),k.find("div.phrase_item").click(function(a){stopBubble(a)}),$.fn.closePhrase=function(){var b=$(this);b.removeClass("active").css("height",""),setTimeout(function(){b.removeAttr("style")},a)}}(),function(){for(var c=b.novel,d=c.length,g=['<ul class="novel_list">'],h=(Math.ceil((e-160)/18),0);d>h;h++){{var i=c[h],j=i.title,k=(i.date,i.content);k.length}g.push('<li class="novel_box rel l"><div class="novel_area"><div class="novel_item"><h3 class="l">'+j+'</h3><div class="novel_content fix scroll-pane"><p>'+k.join("</p><p>")+"</p></div></div></div></li>")}g.push("</ul>"),l.append(g.join(""));var m=l.find("div.novel_area h3");m.click(function(b){var c=$(this),d=c.parent(),e=d.parent(),g=e.offset();e.hasClass("active")?e.closeNovel():(e.addClass("active").css({left:16-g.left+"px","z-index":"1"}),setTimeout(function(){e.css("width",f-32+"px"),setTimeout(function(){e.find(".novel_content").jScrollPane()},a)},a)),stopBubble(b)}),l.find("div.novel_area").click(function(a){stopBubble(a)}),$.fn.closeNovel=function(){var b=$(this);b.css("width",""),setTimeout(function(){b.removeClass("active").removeAttr("style")},a)}}()}function d(){for(var a=($.getValues().bodyWidth,$.getValues().bodyHeight,$.getValues().animateTime),b=$(".box_myRecode"),c=b.find("div.content"),d=data_myRecode,e=[],f=0,g=d.length;g>f;f++){var h=d[f],i=h.title,j=h.imgurl,k=h.info;e.push('<div class="recode_area l rel">'),e.push('<div class="recode_box info_box abs"><div class="recode_img ovh"><h3 class="tc">'+i+"</h3><p>"+k+'</p></div><button type="button" class="btn btn-default" data-type="code">返回</button></div>'),e.push('<div class="recode_box code_box abs"><div class="recode_img ovh"><img src="'+j+'"></div><button type="button" class="btn btn-default" data-type="info">简介</button>'),e.push('<button type="button" class="btn btn-default" data-type="target" data-flag="codeurl">查看源码</button><button type="button" class="btn btn-default" data-type="target" data-flag="baseurl">对比原网站</button><button type="button" class="btn btn-default" data-type="target" data-flag="url">打开</button></div></div>')}c.html(e.join("")),c.find("div.recode_area button").click(function(){var b=$(this),c=b.parent().parent(),e=b.data("type"),f=c.index(),g=b.data("flag"),h=c.find("> .info_box"),i=c.find("> .code_box");switch(e){case"info":c.addClass("recode_area_info"),setTimeout(function(){h.css("display","block"),i.css("display","none")},a/2);break;case"code":c.removeClass("recode_area_info"),setTimeout(function(){i.css("display","block"),h.css("display","none")},a/2);break;case"target":window.open(d[f][g])}})}function e(){for(var a=($.getValues().bodyWidth,$.getValues().bodyHeight,$.getValues().animateTime,$(".box_myWork")),b=(a.find("div.content"),a.find("div.work_content")),c=data_myWork,d=2013,e=(new Date).getFullYear(),f=[],g=d;e>=g;g++){f.push('<div class="work_item"><div class="year_flag rel">'+g+'<span class="glyphicon glyphicon-time abs"></span></div></div>');for(var h=1;12>=h;h++)f.push('<div class="work_item" data-flag="'+g+"-"+h+'"><div class="mouth_flag rel">'+h+'月<span class="abs"></span></div><div class="work_box"></div></div>')}b.html(f.join(""));for(var g=0,i=c.length;i>g;g++){var j=c[g],k=j.timeFlag,l=j.type,m=(j.content,b.find('div.work_item[data-flag="'+k+'"]'));switch(l){case"text":!function(a){var b=a.content,c=m.find("div.mouth_flag >span");m.find(".work_box").append("<p>"+b+"</p>");var d=m.find(".work_box >*").length;c.addClass("current"),d>1&&c.html("<em>"+d+"</em>")}(j);break;case"area":!function(a){var b=a.content,c=a.title,d=m.find("div.mouth_flag >span");m.find(".work_box").append('<div class="work_area rel fix"><div class="panel-heading">'+c+"</div>"+b+"</div>");var e=m.find(".work_box >*").length;d.addClass("current"),e>1&&d.html("<em>"+e+"</em>")}(j)}}a.jScrollPane(),setTimeout(function(){a.jScrollPane()},1e3)}function f(){function a(){c.removeClass("endraggable")}var b=($.getValues().bodyWidth,$.getValues().bodyHeight,$.getValues().animateTime,$(".box_myGame")),c=b.find("div.content"),d=b.height(),e=(b.width(),c.find("div.game_area"));c.height(d),e.downDelay({downDuring:433,downEvent:a}).draggable({addClasses:!1,cancel:".endraggable"})}var g={myInformation:a,myPhotos:b,myArticle:c,myRecode:d,myWork:e,myGame:f};$.extend({initModule:function(a){var b=a.target;g[b]()}})});